@import 'tailwindcss';

/* ============================================
   Design System: Techy Minimal
   ============================================ */

:root {
  /* ===== Color Palette ===== */
  /* Surface colors (dark to light) */
  --darkest: oklch(0.1398 0 0);              /* Pure black - for sidebars only */
  --darker: oklch(0.1448 0 0);         /* Near black - main background */
  --dark: oklch(0.1589 0.0021 286.18);    /* Dark gray - cards/elevated */
  --smoke: oklch(0.20 0.01 280);       /* Medium gray - hover states */
  --ash: oklch(0.24 0.01 280);         /* Light gray - active states */
  
  /* Text colors */
  --text-primary: oklch(1 0 0);          /* Pure white */
  --text-secondary: oklch(1 0 0 / 0.7);  /* 70% opacity white */
  --text-tertiary: oklch(1 0 0 / 0.4);   /* 40% opacity white */
  
  /* Border colors */
  --border-subtle: oklch(0.95 0 0 / 0.06);  /* 6% opacity soft white */
  --border-default: oklch(0.2779 0.0093 276.78); /* 10% opacity soft white */
  --border-strong: oklch(0.95 0 0 / 0.16);  /* 16% opacity soft white */
  
  /* Accent colors */
  --accent-primary: oklch(0.65 0.28 275);  /* Vibrant Purple */
  --accent-success: oklch(0.72 0.20 162);  /* Rich Green */
  --accent-danger: oklch(0.65 0.25 25);    /* Vivid Red */
  --accent-warning: oklch(0.78 0.18 70);   /* Bright Orange */
  --accent-info: oklch(0.67 0.24 252);     /* Electric Blue */
  
  /* ===== Semantic Layout Areas ===== */
  /* Dark mode by default */
  --main-sidebar: var(--darkest);      /* Leftmost navigation - pure black for clean feel */
  --main-sidebar-foreground: var(--text-secondary);
  --main-sidebar-hover: var(--smoke);
  --main-sidebar-active: var(--smoke);
  
  --workspace-sidebar: var(--darker);  /* Channels/conversations sidebar - near black */
  --workspace-sidebar-foreground: var(--text-secondary);
  --workspace-sidebar-hover: var(--smoke);
  --workspace-sidebar-active: var(--smoke);
  
  --content-area: var(--dark);  /* Main chat/content area - near black */
  
  /* ===== Semantic Component Colors (ShadCN Compatible) ===== */
  --background: var(--content-area);
  --foreground: var(--text-primary);
  --card: var(--dark);
  --card-foreground: var(--text-primary);
  --popover: var(--dark);
  --popover-foreground: var(--text-primary);
  --primary: var(--text-primary);         
  --primary-foreground: var(--text-primary);      /* Dark background */
  --secondary: var(--dark);
  --secondary-foreground: var(--text-primary);
  --muted: var(--ash);
  --muted-foreground: var(--text-secondary);
  --accent: var(--smoke);
  --accent-foreground: var(--text-primary);
  --destructive: var(--accent-danger);
  --destructive-foreground: var(--text-primary);
  --border: var(--border-default);
  --input: var(--content-area);         
  --ring: var(--primary);
  --chart-1: var(--accent-primary);
  --chart-2: var(--accent-info);
  --chart-3: var(--accent-success);
  --chart-4: var(--accent-warning);
  --chart-5: var(--accent-danger);
  
  /* ===== Link Colors ===== */
  --link: oklch(0.65 0.22 252);
  --link-hover: oklch(0.72 0.25 252);
  
  /* ===== Interactive States ===== */
  --interactive-active: oklch(0.95 0.05 252);
  --interactive-active-border: oklch(0.85 0.08 252);
  --interactive-active-text: oklch(0.35 0.12 252);
  --interactive-active-hover: oklch(0.92 0.06 252);
  
  --interactive-inactive: oklch(0.96 0 0);
  --interactive-inactive-border: oklch(0.85 0 0);
  --interactive-inactive-text: oklch(0.45 0 0);
  --interactive-inactive-hover: oklch(0.92 0 0);
  
  /* ===== Brand Colors ===== */
  --brand-green: oklch(0.72 0.20 162);
  --brand-blue: oklch(0.55 0.22 252);
  
  /* ===== Modern Tech UI Grid System ===== */
  /* Base Grid: 4px for maximum flexibility */
  /* Component Grid: 8px for layouts */
  
  /* Standard Tailwind Spacing Scale */
  --spacing-0: 0;          /* 0px */
  --spacing-px: 1px;       /* 1px */
  --spacing-0-5: 0.125rem; /* 2px */
  --spacing-1: 0.25rem;    /* 4px */
  --spacing-1-5: 0.375rem; /* 6px */
  --spacing-2: 0.5rem;     /* 8px */
  --spacing-2-5: 0.625rem; /* 10px */
  --spacing-3: 0.75rem;    /* 12px */
  --spacing-3-5: 0.875rem; /* 14px */
  --spacing-4: 1rem;       /* 16px */
  --spacing-5: 1.25rem;    /* 20px */
  --spacing-6: 1.5rem;     /* 24px */
  --spacing-7: 1.75rem;    /* 28px */
  --spacing-8: 2rem;       /* 32px */
  --spacing-9: 2.25rem;    /* 36px */
  --spacing-10: 2.5rem;    /* 40px */
  --spacing-11: 2.75rem;   /* 44px - mobile touch target */
  --spacing-12: 3rem;      /* 48px */
  --spacing-14: 3.5rem;    /* 56px */
  --spacing-16: 4rem;      /* 64px */
  --spacing-20: 5rem;      /* 80px */
  --spacing-24: 6rem;      /* 96px */
  --spacing-28: 7rem;      /* 112px */
  --spacing-32: 8rem;      /* 128px */
  
  /* Touch Targets */
  --touch-target-mobile: 2.75rem;   /* 44px - minimum mobile touch target */
  --touch-target-desktop: 2rem;     /* 32px - minimum desktop touch target */
  
  /* Border Radius Scale (refined, smaller values) */
  --radius-sm: 0.125rem;   /* 2px */
  --radius: 0.375rem;      /* 6px - default */
  --radius-lg: 0.5rem;     /* 8px */
  --radius-xl: 0.75rem;    /* 12px */
  --radius-2xl: 1rem;      /* 16px */
  --radius-full: 9999px;   /* Full radius */
  
  /* ===== Utility Variables ===== */
  --font-sans: var(--font-noto-sans), -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
  
  /* ===== ShadCN Component Overrides ===== */
  /* These extend our semantic tokens with ShadCN-specific mappings */
  --tooltip: var(--popover);
  --tooltip-foreground: var(--popover-foreground);
  --sidebar: var(--main-sidebar);
  --sidebar-primary: var(--workspace-sidebar);
  --sidebar-primary-foreground: var(--workspace-sidebar-foreground);
  --sidebar-accent: var(--workspace-sidebar-active);
  --sidebar-accent-foreground: var(--workspace-sidebar-foreground);
  --sidebar-border: var(--border-subtle);
  --sidebar-ring: var(--ring);
}

/* ===== Light Theme Overrides ===== */
.light {
  /* Invert surface colors for light mode */
  --darkest: oklch(1 0 0);                /* Pure white background */
  --darker: oklch(0.98 0.005 60);         /* Warm off-white */
  --dark: oklch(0.96 0.008 60);    /* Light gray with warmth */
  --smoke: oklch(0.94 0.01 60);        /* Medium light gray */
  --ash: oklch(0.90 0.012 60);         /* Darker gray for contrast */
  
  /* Text colors for light mode */
  --text-primary: oklch(0.10 0.03 280);    /* Deep rich black */
  --text-secondary: oklch(0.35 0.02 280);  /* Strong gray */
  --text-tertiary: oklch(0.55 0.015 280);  /* Medium gray */
  
  /* Borders for light mode */
  --border-subtle: oklch(0.15 0.02 280 / 0.08);
  --border-default: oklch(0.15 0.02 280 / 0.12);
  --border-strong: oklch(0.15 0.02 280 / 0.20);
  
  /* Update sidebar states for light mode */
  --main-sidebar: var(--dark);      /* Leftmost navigation sidebar */
  --main-sidebar-foreground: var(--text-secondary);
  --main-sidebar-hover: var(--smoke);
  --main-sidebar-active: var(--smoke);
  
  --workspace-sidebar: var(--darker);       /* Channels/conversations sidebar */
  --workspace-sidebar-foreground: var(--text-secondary);
  --workspace-sidebar-hover: var(--dark);
  --workspace-sidebar-active: var(--dark);
  
  --content-area: var(--darkest);           /* Main chat/content area - pure white */
  
  /* Link colors for light mode */
  --link: oklch(0.48 0.25 252);
  --link-hover: oklch(0.40 0.28 252);
  
  /* Interactive states for light mode */
  --interactive-active: oklch(0.15 0.08 252);
  --interactive-active-border: oklch(0.4 0.12 252);
  --interactive-active-text: oklch(0.7 0.15 252);
  --interactive-active-hover: oklch(0.18 0.1 252);
  
  --interactive-inactive: oklch(0.2 0 0);
  --interactive-inactive-border: oklch(0.35 0 0);
  --interactive-inactive-text: oklch(0.65 0 0);
  --interactive-inactive-hover: oklch(0.25 0 0);
  
  /* Light mode component overrides */
  --primary: oklch(0.08 0 0);            /* Near black button for light mode */
  --primary-foreground: oklch(0.98 0 0); /* Near white text on dark button */
  --ring: oklch(0.08 0 0 / 0.3);
  --input: var(--dark);
}

/* ===== Tailwind Color Mappings ===== */
@theme inline {
  /* Surface colors */
  --color-darkest: var(--darkest);
  --color-darker: var(--darker);
  --color-dark: var(--dark);
  --color-smoke: var(--smoke);
  --color-ash: var(--ash);
  
  /* Text colors */
  --color-text-primary: var(--text-primary);
  --color-text-secondary: var(--text-secondary);
  --color-text-tertiary: var(--text-tertiary);
  
  /* Border colors */
  --color-border-subtle: var(--border-subtle);
  --color-border-default: var(--border-default);
  --color-border-strong: var(--border-strong);
  
  /* Accent colors */
  --color-accent-primary: var(--accent-primary);
  --color-accent-success: var(--accent-success);
  --color-accent-danger: var(--accent-danger);
  --color-accent-warning: var(--accent-warning);
  --color-accent-info: var(--accent-info);
  
  /* Layout areas */
  --color-main-sidebar: var(--main-sidebar);
  --color-main-sidebar-foreground: var(--main-sidebar-foreground);
  --color-main-sidebar-hover: var(--main-sidebar-hover);
  --color-main-sidebar-active: var(--main-sidebar-active);
  --color-workspace-sidebar: var(--workspace-sidebar);
  --color-workspace-sidebar-foreground: var(--workspace-sidebar-foreground);
  --color-workspace-sidebar-hover: var(--workspace-sidebar-hover);
  --color-workspace-sidebar-active: var(--workspace-sidebar-active);
  --color-content-area: var(--content-area);
  
  /* Brand colors */
  --color-brand-green: var(--brand-green);
  --color-brand-blue: var(--brand-blue);
  
  /* ShadCN semantic component mappings */
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-card: var(--card);
  --color-card-foreground: var(--card-foreground);
  --color-popover: var(--popover);
  --color-popover-foreground: var(--popover-foreground);
  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);
  --color-secondary: var(--secondary);
  --color-secondary-foreground: var(--secondary-foreground);
  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);
  --color-accent: var(--accent);
  --color-accent-foreground: var(--accent-foreground);
  --color-destructive: var(--destructive);
  --color-destructive-foreground: var(--destructive-foreground);
  --color-border: var(--border);
  --color-input: var(--input);
  --color-ring: var(--ring);
  --color-chart-1: var(--chart-1);
  --color-chart-2: var(--chart-2);
  --color-chart-3: var(--chart-3);
  --color-chart-4: var(--chart-4);
  --color-chart-5: var(--chart-5);
  
  /* ShadCN extended tokens */
  --color-tooltip: var(--tooltip);
  --color-tooltip-foreground: var(--tooltip-foreground);
  --color-sidebar: var(--sidebar);
  --color-sidebar-primary: var(--sidebar-primary);
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-ring: var(--sidebar-ring);
  
  /* Link colors */
  --color-link: var(--link);
  --color-link-hover: var(--link-hover);
  
  /* Interactive states */
  --color-interactive-active: var(--interactive-active);
  --color-interactive-active-border: var(--interactive-active-border);
  --color-interactive-active-text: var(--interactive-active-text);
  --color-interactive-active-hover: var(--interactive-active-hover);
  --color-interactive-inactive: var(--interactive-inactive);
  --color-interactive-inactive-border: var(--interactive-inactive-border);
  --color-interactive-inactive-text: var(--interactive-inactive-text);
  --color-interactive-inactive-hover: var(--interactive-inactive-hover);
  
  /* Utilities */
  --radius: var(--radius);
  --font-sans: var(--font-sans);
  
  /* Standard Tailwind spacing scale */
  --spacing-0: 0;
  --spacing-px: 1px;
  --spacing-0-5: 0.125rem;    /* 2px */
  --spacing-1: 0.25rem;       /* 4px */
  --spacing-1-5: 0.375rem;    /* 6px */
  --spacing-2: 0.5rem;        /* 8px */
  --spacing-2-5: 0.625rem;    /* 10px */
  --spacing-3: 0.75rem;       /* 12px */
  --spacing-3-5: 0.875rem;    /* 14px */
  --spacing-4: 1rem;          /* 16px */
  --spacing-5: 1.25rem;       /* 20px */
  --spacing-6: 1.5rem;        /* 24px */
  --spacing-7: 1.75rem;       /* 28px */
  --spacing-8: 2rem;          /* 32px */
  --spacing-9: 2.25rem;       /* 36px */
  --spacing-10: 2.5rem;       /* 40px */
  --spacing-11: 2.75rem;      /* 44px */
  --spacing-12: 3rem;         /* 48px */
  --spacing-14: 3.5rem;       /* 56px */
  --spacing-16: 4rem;         /* 64px */
  --spacing-20: 5rem;         /* 80px */
  --spacing-24: 6rem;         /* 96px */
  --spacing-28: 7rem;         /* 112px */
  --spacing-32: 8rem;         /* 128px */
  
  /* Touch targets */
  --touch-target-mobile: var(--touch-target-mobile);
  --touch-target-desktop: var(--touch-target-desktop);
  
  /* Border radius */
  --radius-sm: var(--radius-sm);
  --radius-lg: var(--radius-lg);
  --radius-xl: var(--radius-xl);
  --radius-2xl: var(--radius-2xl);
  --radius-full: var(--radius-full);
}

/* ===== Base Styles ===== */
@layer base {
  * {
    @apply border-border;
  }
  
  html, body {
    height: 100%;
  }

  body {
    @apply bg-background text-foreground;
    font-family: var(--font-sans);
    font-feature-settings: 'rlig' 1, 'calt' 1;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    font-size: 14px;
    line-height: 1.5;
  }

  :focus-visible {
    @apply outline-2 outline-ring outline-offset-2;
  }
}

/* ===== Component Utilities ===== */
@layer utilities {
  .text-balance {
    text-wrap: balance;
  }

  .messages-scrollbar {
    scrollbar-width: thin;
    scrollbar-color: var(--muted-foreground) transparent;
  }

  .messages-scrollbar::-webkit-scrollbar {
    width: 6px;
  }

  .messages-scrollbar::-webkit-scrollbar-track {
    background: transparent;
  }

  .messages-scrollbar::-webkit-scrollbar-thumb {
    background-color: var(--muted-foreground);
    border-radius: 3px;
  }

  .messages-scrollbar::-webkit-scrollbar-thumb:hover {
    background-color: var(--foreground);
  }
}

/* ===== Component Styles ===== */
@layer components {
  /* Message highlighting animation */
  .message-highlighted {
    animation: highlight-pulse 3s ease-in-out;
    border: 1px solid transparent;
  }
  
  @keyframes highlight-pulse {
    0%, 100% { background-color: transparent; }
    50% { background-color: var(--brand-blue); }
  }

  /* Quill Editor Styles */
  .ql-toolbar {
    @apply !border-none !rounded-md !bg-input !p-2;
  }

  .ql-toolbar .ql-formats:not(:last-child) {
    @apply !border-none !rounded-md !pr-3 !mr-3;
  }

  .ql-toolbar .ql-stroke {
    stroke: var(--muted-foreground) !important;
  }

  .ql-toolbar .ql-fill {
    fill: var(--muted-foreground) !important;
  }

  .ql-toolbar button:hover {
    @apply !bg-accent;
  }

  .ql-toolbar button.ql-active {
    @apply !bg-accent;
  }

  .ql-container {
    @apply !font-sans !border-0 !rounded-b-md max-h-80 overflow-y-auto;
  }

  .ql-editor {
    @apply !leading-6 !p-4 !text-foreground !font-normal !font-sans !text-sm !min-h-20 max-h-64 overflow-y-auto;
  }

  .ql-editor.ql-blank::before {
    @apply !text-muted-foreground !not-italic !left-4;
  }

  .ql-tooltip {
    @apply !hidden;
  }

  /* Message Content Styles */
  .message-content {
    box-sizing: border-box;
    line-height: 1.5;
    height: auto;
    outline: none;
    overflow-wrap: break-word;
    word-wrap: break-word;
    tab-size: 4;
    -moz-tab-size: 4;
    text-align: left;
    color: var(--foreground);
    max-width: none;
    white-space: normal;
  }

  .message-content > *:first-child {
    margin-top: 0 !important;
  }

  .message-content > *:last-child {
    margin-bottom: 0 !important;
  }

  .message-content p {
    margin: 0 0 0.75rem 0;
    line-height: 1.5;
    white-space: pre-wrap;
  }

  .message-content p:last-child {
    margin-bottom: 0;
  }

  .message-content h1, .message-content h2, .message-content h3,
  .message-content h4, .message-content h5, .message-content h6 {
    font-weight: 700;
    line-height: 1.3;
    margin: 1.25rem 0 0.5rem 0;
    white-space: normal;
  }

  .message-content h1 { font-size: 1.25rem; }
  .message-content h2 { font-size: 1.125rem; }
  .message-content h3 { font-size: 1.0625rem; }
  .message-content h4 { font-size: 1rem; font-weight: 600; }
  .message-content h5 { font-size: 0.9375rem; font-weight: 600; }
  .message-content h6 { font-size: 0.875rem; font-weight: 600; }

  .message-content h1 + *, .message-content h2 + *, .message-content h3 + *,
  .message-content h4 + *, .message-content h5 + *, .message-content h6 + * {
    margin-top: 0;
  }

  .message-content ul, .message-content ol {
    margin: 0.75rem 0;
    padding-left: 1.5rem;
    white-space: normal;
  }

  .message-content li {
    margin-bottom: 0.25rem;
    line-height: 1.4;
    white-space: normal;
  }

  .message-content li > ul, .message-content li > ol {
    margin: 0.25rem 0 0 0;
  }

  .message-content ul { list-style-type: disc; }
  .message-content ul ul { list-style-type: circle; }
  .message-content ul ul ul { list-style-type: square; }
  .message-content ul ul ul ul { list-style-type: disc; }

  .message-content ol { list-style-type: decimal; }
  .message-content ol ol { list-style-type: lower-alpha; }
  .message-content ol ol ol { list-style-type: lower-roman; }
  .message-content ol ol ol ol { list-style-type: decimal; }

  .message-content ul ol { list-style-type: decimal; }
  .message-content ol ul { list-style-type: disc; }

  .message-content blockquote, .message-content .ql-blockquote,
  .message-content p[class*='blockquote'], .message-content [data-blockquote='true'] {
    border-left: 3px solid var(--muted-foreground) !important;
    padding: 0.75rem 0 0.75rem 1rem !important;
    margin: 0.75rem 0 !important;
    background-color: var(--muted) !important;
    font-style: italic !important;
    border-radius: 0 var(--radius) var(--radius) 0 !important;
    white-space: normal !important;
  }

  .message-content blockquote p:last-child {
    margin-bottom: 0;
  }

  .message-content pre {
    background-color: var(--ash);
    border: 1px solid var(--border);
    padding: 0.75rem;
    border-radius: var(--radius);
    margin: 0.75rem 0;
    overflow-x: auto;
    font-size: 0.875rem;
    line-height: 1.4;
    white-space: pre;
  }

  .message-content code {
    background-color: var(--muted);
    padding: 0.125rem 0.375rem;
    border-radius: var(--radius-sm);
    font-size: 0.875rem;
    font-family: ui-monospace, SFMono-Regular, 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
    border: 1px solid var(--border);
    white-space: pre;
  }

  .message-content pre code {
    background-color: transparent;
    padding: 0;
    border: none;
  }

  .message-content p code {
    margin: 0 0.125rem;
    white-space: pre-wrap;
  }

  .message-content table {
    border-collapse: collapse;
    width: 100%;
    margin: 1rem 0;
    border: 1px solid var(--border);
    border-radius: var(--radius);
    overflow: hidden;
    white-space: normal;
  }

  .message-content th, .message-content td {
    border: 1px solid var(--border);
    padding: 0.75rem;
    text-align: left;
    color: var(--foreground);
    vertical-align: top;
    white-space: normal;
  }

  .message-content th {
    background-color: var(--muted);
    font-weight: 600;
    font-size: 0.875rem;
  }

  .message-content tbody tr:nth-child(even) {
    background-color: color-mix(in srgb, var(--muted) 30%, transparent);
  }

  .message-content tbody tr:hover {
    background-color: color-mix(in srgb, var(--muted) 50%, transparent);
  }

  .message-content a {
    color: var(--link);
    text-decoration: none;
    cursor: pointer;
    transition: all 0.2s ease-in-out;
    border-bottom: 1px solid transparent;
    white-space: normal;
  }

  .message-content a:hover {
    color: var(--link-hover);
    border-bottom-color: var(--link-hover);
  }

  .message-content strong, .message-content b { font-weight: 600; }
  .message-content em, .message-content i { font-style: italic; }
  .message-content u { text-decoration: underline; }
  .message-content s, .message-content strike { text-decoration: line-through; }

  .message-content hr {
    border: none;
    height: 1px;
    background-color: var(--border);
    margin: 1.5rem 0;
  }

  .message-content img {
    max-width: 100%;
    height: auto;
    border-radius: var(--radius-lg);
    margin: 1rem 0;
    border: 1px solid var(--border);
  }

  .message-content sub, .message-content sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
  }

  .message-content sup { top: -0.5em; }
  .message-content sub { bottom: -0.25em; }

  .message-content .ql-align-center { text-align: center; }
  .message-content .ql-align-right { text-align: right; }
  .message-content .ql-align-justify { text-align: justify; }

  .message-content .ql-indent-1 { padding-left: 3em; }
  .message-content .ql-indent-2 { padding-left: 6em; }
  .message-content .ql-indent-3 { padding-left: 9em; }
  .message-content .ql-indent-4 { padding-left: 12em; }
  .message-content .ql-indent-5 { padding-left: 15em; }
  .message-content .ql-indent-6 { padding-left: 18em; }
  .message-content .ql-indent-7 { padding-left: 21em; }
  .message-content .ql-indent-8 { padding-left: 24em; }

  .message-content .preserve-whitespace {
    white-space: pre-wrap;
  }

  .message-content br {
    display: block;
    content: '';
    margin: 0.25rem 0;
  }

  .flat-typing-indicator {
    background: var(--muted);
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
  }
}